datasource db {
  provider = "postgresql"
}

generator client {
  provider = "prisma-client"
   output   = "../src/generated/prisma"
}

model User {
  id            Int            @id @default(autoincrement())
  name          String
  email         String         @unique
  password      String
  createdAt     DateTime       @default(now())

  conversations Conversation[]
}

model Conversation {
  id        Int          @id @default(autoincrement())
  userId    Int
  user      User         @relation(fields: [userId], references: [id])

  title     String?
  createdAt DateTime     @default(now())
  updatedAt DateTime     @updatedAt

  messages  Message[]

  @@index([userId])
}

enum MessageRole {
  USER
  ASSISTANT
}

model Message {
  id             Int          @id @default(autoincrement())
  conversationId Int
  conversation   Conversation @relation(fields: [conversationId], references: [id])

  role           MessageRole
  content        String
  createdAt      DateTime     @default(now())

  @@index([conversationId, createdAt])
}
